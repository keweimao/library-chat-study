# Chat Topic Analysis Comparison
This collection of programs were developed for the Library at the University of Northern Iowa to study the performance of unsupervised and semi-supervised topic modeling techniques on its library's chat reference data obtained its LibChat system. It integrates 4 unsupervised and 2 semi-supervised topic models and calculates TC-PMI, TC-LCP, and TC-NZ topic coherence scores as a reference for users to evaluate the performance of the models.

Unsupervised Models available:
* TF-IDF & LSA  (using gensim)
* TF-IDF & pLSA (using gensim)
* LDA (using sklearn)
* PyMallet LDA (https://github.com/mimno/PyMallet)

Semi-supervised Models available:
* GuidedLDA (using https://github.com/vi3k6i5/GuidedLDA)
* CorEx (Correlation Explanation (using https://github.com/gregversteeg/corex_topic)

## Getting Started

### Files

There are 3 main components of the program:
* Phase 1 P1_preprocessing_data.py
* Phase 2 P2_unsupervised_topic_modeling.py
* Phase 3 P3_semi_supervised_topic_modeling.py

Please make sure all of the above files are placed in the same directory, as well as the raw chat (.csv) format to process.

### Input Format

Please check the structure of the raw chat (.csv) file obtained LibChat.  It should be a .csv file where each line of the chat conversation is an individual line in the .csv, and the .csv contains the following columns:
| Timestamp | Duration (seconds) | Initial Question | Message Count | Transcript |
|-----------|--------------------|------------------|---------------|------------|

(The above format is based on the way the LibChat software was set up at the time of this project.)

### Installing

Before running the Phase 1 or 2 programs, please install all Python packages used:

* numpy
* pandas
* nltk
* sklearn
* gensim
* pprint
* six

You may either use Anaconda or pip command to install the packages mentioned.

```
pip install pandas
```

In case of NLTK stopword failure, please download the stopword files from NLTK manually. You may want to run the following commands in Python console:

```
import nltk
nltk.download('stopwords')
```
Before running the Phase 3 Semi-supervised topic modeling program you will need to install the CorEx and GuidedLDA packages.

* CorEx (Correlation Explanation) package available at GitHub:
    https://github.com/gregversteeg/corex_topic

* GuidedLDA package is available at GitHub:
    https://github.com/vi3k6i5/GuidedLDA
    NOTE:  We had difficulty installing GuidedLDA, but we were finally successful
    by following the work-around posted at:
    https://github.com/dex314/GuidedLDA_WorkAround

## Running

Phase 1 P1_preprocessing_data.py  -> Phase 2 P2_unsupervised_topic_modeling.py -> Phase 3 P3_semi_supervised_topic_modeling.py
Please follow the instructions for each Phase below.

### Phase 1 Preprocessing Data

Step 1. Please input the raw LibChat (.csv) file name.

Step 2. Please input the stop words (.txt) file name (e.g., stop_words.txt).

...

Total Question Count: 8852 written to onlyQuestionsFile.txt

Whole Chats Count: 9146 written to wholeChatsFile.txt

Whole Chats Count: 9146 written to wholeChatsFilePOS_N_ADJ.txt

Whole Chats Count: 9146 written to wholeChatsFilePOS_N_ADJ_V.txt

At last, you will get 4 new .txt files generated by Phase 1.  They are: wholeChatsFile.txt, wholeChatsFilePOS_N_ADJ_V.txt, 
wholeChatsFilePOS_N_ADJ.txt, and onlyQuestionsFile.txt.

### Phase 2 Perform Unsupervised Topic Modeling

Step 1. Please input the preprocessed (.txt) file from Phase 1 (e.g. wholeChatsFile.txt).

Step 2. Please specify the number of topics. (suggested range 10-20)

Step 3. Please specify the number of words per topics. (suggested range 5-10)

... 

<Perform the four unsupervised topic modeling techniques -- displaying the topic coherence scores and the resulting topics for each>

Performing TF-IDF & pLSA topic modeling -- please wait it might take a couple minutes!

Results for TF-IDF & pLSA  TC-PMI 0.312, TC-LCP -0.796, TC-NZ 0.000:

article link good doe search class answer author

book check number renew online today copy hold

reserve room study digital medium hub camera people

search bar book homepage click type onesearch result

access link click loan interlibrary account request log

good chat contact campus email today center online

access print campus computer link doe click log

article access attach file journal title amp google

librarian research email contact appointment question paper consultation

today open hour close awesome pm time doe

check answer place shortly doe question long movie

floor collection locate number special main art area

desk circulation student hold laptop long checkout minute

database access journal review research az paper peer

link cite file attach work send click apa

At last, you will get text (.txt) files generated by Phase 2 containing the topics of each of the 4 unsupervised techniques.

Plus, to aid is deciding appropriate anchors/seeds for the semi-supervised topic modeling techniques in Phase 3, two additional text files are produced:
* possible_2_word_anchors.txt most frequent 2-word occurrence across combined topics of all four unsupervised topic modeling techniques
* possible_3_word_anchors.txt most frequent 3-word occurrence across combined topics of all four unsupervised topic modeling techniques      

